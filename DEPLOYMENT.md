# Deployment Guide - Expense Tracker Backend

## Overview
The backend has been successfully migrated from MySQL to PostgreSQL and is ready for deployment on Render.

## Deployment Status âœ…

### Completed Tasks:
1. **Database Migration**: Successfully migrated from MySQL to PostgreSQL
   - Updated `pom.xml` with PostgreSQL driver (version 42.7.4)
   - Updated Spring Boot to version 3.3.13
   - Configured `application.properties` for PostgreSQL with environment variables

2. **Build System**: Maven build is working correctly
   - Dependencies resolved successfully
   - Jar file created: `target/myProject-0.0.1-SNAPSHOT.jar`
   - All 48 source files compiled without errors

3. **Deployment Configuration**: All deployment files are ready
   - `Dockerfile` - Configured for OpenJDK 21 and PostgreSQL
   - `render.yaml` - Complete service configuration
   - `build.sh` - Build script for Render deployment

## Deployment Steps for Render

### Prerequisites:
- Frontend already deployed on Vercel (âœ… completed)
- Render account ready
- This repository pushed to GitHub/GitLab

### Deploy to Render:

1. **Create New Web Service**:
   - Connect your repository
   - Use existing `render.yaml` configuration
   - Render will automatically detect the configuration

2. **Database Setup**:
   - Render will create PostgreSQL database automatically
   - Database connection will be provided via `DATABASE_URL` environment variable

3. **Environment Variables** (Auto-configured in render.yaml):
   ```
   DATABASE_URL=<auto-provided-by-render>
   JWT_SECRET_KEY=<auto-generated>
   EMAIL_USERNAME=<configure-manually>
   EMAIL_PASSWORD=<configure-manually>
   CORS_ALLOWED_ORIGINS=https://your-frontend-vercel-url.vercel.app
   UPLOAD_DIR=/tmp/uploads
   SPRING_PROFILES_ACTIVE=production
   ```

4. **Update Frontend**:
   - Update your Vercel frontend's API base URL to point to the new Render backend URL
   - Format: `https://your-backend-service.onrender.com`

## Configuration Details

### Database Configuration
- **Driver**: PostgreSQL JDBC Driver 42.7.4
- **Connection**: Environment variable based (`DATABASE_URL`)
- **JPA**: Hibernate with automatic DDL updates

### Security Features
- JWT Authentication
- CORS configured for Vercel frontend
- File upload security with size limits

### API Endpoints
All existing endpoints remain the same:
- Authentication: `/api/auth/**`
- Expenses: `/api/expenses/**`
- Receipts: `/api/receipts/**`
- Users: `/api/users/**`
- And more...

### File Storage
- Receipts stored in `/tmp/uploads` (Render's temporary storage)
- File validation: PNG, PDF formats supported
- Size limit: 50MB per file

## Verification Steps

After deployment:
1. Check health endpoint: `https://your-backend.onrender.com/actuator/health`
2. Test login functionality
3. Verify CORS is working with your Vercel frontend
4. Test file upload functionality

## Troubleshooting

### Common Issues:
1. **Database Connection**: Ensure DATABASE_URL is properly set
2. **CORS Errors**: Update CORS_ALLOWED_ORIGINS with your Vercel URL
3. **File Uploads**: Check UPLOAD_DIR permissions

### Logs:
- View logs in Render dashboard
- Check Spring Boot actuator endpoints for monitoring

## Next Steps

1. Deploy backend to Render using the configuration files
2. Get the Render backend URL
3. Update frontend environment variables with new backend URL
4. Test the full application end-to-end
5. Configure email settings for production notifications

## Files Ready for Deployment
- âœ… `pom.xml` - Maven configuration with PostgreSQL
- âœ… `application.properties` - Environment-based configuration
- âœ… `Dockerfile` - Container configuration
- âœ… `render.yaml` - Render service configuration  
- âœ… `build.sh` - Build script
- âœ… `target/myProject-0.0.1-SNAPSHOT.jar` - Deployable jar file

Your backend is now ready for production deployment! ðŸš€